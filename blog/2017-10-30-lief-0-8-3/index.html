<!doctype html><html lang=en-us prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=description content><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=google-site-verification content="OcWjYs0PdsQZtqu1ms5QSr5FplDf_t5GEneU---wWzM"><meta name=description content="This blog post introduces new features in LIEF 0.8.3 as well as some uses cases."><meta name=keywords content><meta property="og:type" content="article"><meta property="og:description" content="This blog post introduces new features in LIEF 0.8.3 as well as some uses cases."><meta property="og:title" content="Have fun with LIEF and Executable Formats!"><meta property="og:site_name" content="LIEF"><meta property="og:image" content="https://lief.re/blog/2017-10-30-lief-0-8-3/featured.png"><meta property="og:image:type" content="image/png"><meta property="og:image:width" content><meta property="og:image:height" content><meta property="og:url" content="https://lief.re/blog/2017-10-30-lief-0-8-3/"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2017-10-30
"><meta property="article:modified_time" content="2017-10-30
"><meta name=twitter:card content="summary"><meta name=twitter:site content="@lief_project"><meta name=twitter:creator content="@lief_project"><meta name=twitter:title content="Have fun with LIEF and Executable Formats! | LIEF"><meta name=twitter:description content="This blog post introduces new features in LIEF 0.8.3 as well as some uses cases. | LIEF"><meta property="twitter:image:src" content="https://lief.re/blog/2017-10-30-lief-0-8-3/featured.png"><meta name=twitter:domain content="https://lief.re/blog/2017-10-30-lief-0-8-3/"><title>LIEF</title>
<link rel=canonical href=https://lief.re/blog/2017-10-30-lief-0-8-3/><link rel=stylesheet type=text/css href=https://lief.re//css/theme.min.css><link rel=stylesheet type=text/css href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css><link rel=stylesheet type=text/css href=https://lief.re//css/vendor.min.css><link rel=stylesheet type=text/css href=https://lief.re//css/termynal.css><link rel=stylesheet type=text/css href=https://lief.re//css/animate.css><link rel=apple-touch-icon href=https://lief.re//img/favicon.ico type=image/x-icon><link rel="shortcut icon" href=https://lief.re//img/favicon.ico type=image/x-icon><link rel=icon href=https://lief.re//img/favicon.ico type=image/x-icon><style></style></head><body class=bg-light><nav class="navbar navbar-expand-lg navbar-light bg-light position-absolute w-100 bg-white" role=navigation><div class="container position-relative"><a href=https://lief.re/ class=navbar-brand>LIEF</a>
<button class=navbar-toggler data-toggle=collapse data-target=#navbar-collapse>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse justify-content-end mt-2 mt-lg-0" id=navbar-collapse><ul class=navbar-nav><li class=nav-item><a class=nav-link href=https://lief.re/><i class="fa-solid fa-house mr-3"></i>
Home</a></li><li class=nav-item><a class=nav-link href=https://lief.re/blog><i class="fa-solid fa-rss mr-3"></i>
Blog</a></li><li class=nav-item><a class=nav-link href=https://lief.re/download><i class="fa-solid fa-download mr-3"></i>
Download</a></li><li class="nav-item dropdown"><a href=https://lief.re/doc/latest class="nav-link dropdown-toggle" data-toggle=dropdown><i class="fa-solid fa-book mr-3"></i>
Documentation</a><div class="dropdown-menu px-4" role=menu><a class="dropdown-item d-flex align-items-center border-bottom border-gray-100 p-2" href=https://lief.re/doc/latest/><span class="svg-icon text-purple mr-3"><svg width="512" height="512" viewBox="0 0 512 512"><title>ionicons-v5-m</title><path d="M160 389a20.91 20.91.0 01-13.82-5.2l-128-112a21 21 0 010-31.6l128-112a21 21 0 0127.66 31.61L63.89 256l109.94 96.19A21 21 0 01160 389z"/><path d="M352 389a21 21 0 01-13.84-36.81L448.11 256 338.17 159.81a21 21 0 0127.66-31.61l128 112a21 21 0 010 31.6l-128 112A20.89 20.89.0 01352 389z"/></svg>
</span><span><p class=mb-0>API
<span class="badge badge-pastel-success font-weight-bold pt-2 ml-1">Latest</span></p><span class=text-secondary>Sphinx & Doxygen API documentation</span>
</span></a><a class="dropdown-item d-flex align-items-center border-bottom border-gray-100 p-2" href=https://lief.re/doc/stable/><span class="svg-icon text-purple mr-3"><svg width="512" height="512" viewBox="0 0 512 512"><title>ionicons-v5-m</title><path d="M160 389a20.91 20.91.0 01-13.82-5.2l-128-112a21 21 0 010-31.6l128-112a21 21 0 0127.66 31.61L63.89 256l109.94 96.19A21 21 0 01160 389z"/><path d="M352 389a21 21 0 01-13.84-36.81L448.11 256 338.17 159.81a21 21 0 0127.66-31.61l128 112a21 21 0 010 31.6l-128 112A20.89 20.89.0 01352 389z"/></svg>
</span><span><p class=mb-0>API
<span class="badge badge-pastel-primary font-weight-bold pt-2 ml-1">Stable</span></p><span class=text-secondary>Sphinx & Doxygen API documentation</span>
</span></a><a class="dropdown-item d-flex align-items-center border-bottom border-gray-100 p-2" href=https://lief.re/doc/latest/changelog.html><span class="svg-icon text-purple mr-3"><svg width="512" height="512" viewBox="0 0 512 512"><title>ionicons-v5-j</title><path d="M256 256s-48-96-126-96c-54.12.0-98 43-98 96s43.88 96 98 96c30 0 56.45-13.18 78-32" style="fill:none;stroke:#000;stroke-linecap:round;stroke-miterlimit:10;stroke-width:48px"/><path d="M256 256s48 96 126 96c54.12.0 98-43 98-96s-43.88-96-98-96c-29.37.0-56.66 13.75-78 32" style="fill:none;stroke:#000;stroke-linecap:round;stroke-miterlimit:10;stroke-width:48px"/></svg>
</span><span><p class=mb-0>Changelog</p><span class=text-secondary>See all updates</span></span></a></div></li><li class=nav-item><a class=nav-link href=https://lief.re/about><i class="fa-solid fa-bars-staggered mr-3"></i>
About</a></li><li class="nav-item ml-lg-3 mt-3 mt-lg-0"><a class="hover-lift-light mt-1" href=https://github.com/lief-project/LIEF target=_blank><i class="fab fa-2x fa-github text-darkblue"></i></a></li><li class="nav-item ml-lg-3 mt-3 mt-lg-0"><a class="hover-lift-light mt-1" href=https://discord.gg/jGQtyAYChJ target=_blank><i class="fab fa-2x fa-discord text-darkblue mr-3"></i></a></li><li class="nav-item ml-lg-3 mt-3 mt-lg-0"><a href=https://github.com/sponsors/lief-project/ class="btn btn-outline-pink" target=_blank><i class="fa-solid fa-heart mr-3"></i> Sponsor</a></li></ul></div></div></nav><div class="h-200 h-md-250 bg-light"></div><section class="bg-light pb-8"><div class="container fx-fade-up"><div class="row justify-content-center"><div class="col-lg-12 bg-white shadow-light-lg rounded py-5 px-4 px-md-7 mt-n6"><div class="avatar d-block mx-auto mt-n6 relative-top--7"><a href=https://www.romainthomas.fr target=_blank><img src=https://lief.re/img/avatar/romain.png class="rounded-circle avatar-image shadow" alt=Avatar></a></div><h2 class="text-center font-weight-normal mt-4">Have fun with LIEF and Executable Formats!</h2><div class="text-center text-muted font-size-sm mt-3"><span class=mr-3><span class="svg-icon svg-icon-sm text-muted relative-top--1 mr-1"><svg width="512" height="512" viewBox="0 0 512 512"><title>ionicons-v5-k</title><polygon points="364.13 125.25 87 403 64 448 108.99 425 386.75 147.87 364.13 125.25" style="fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"/><path d="M420.69 68.69 398.07 91.31l22.62 22.63 22.62-22.63a16 16 0 000-22.62h0a16 16 0 00-22.62.0z" style="fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"/></svg>
</span><a href=https://www.romainthomas.fr target=_blank>Romain Thomas </a></span><span class=ml-3><i class="far fa-calendar fa-xs mr-1 relative-top--1"></i>
October 30, 2017</span></div><img src=https://lief.re//img/waves.png class="d-block mx-auto mt-4 mb-5" alt=Wave><div class=text-dark><div class="admonition abstract"><p class=admonition-title>Tl;DR</p>LIEF v0.8.3 is out. The main changelog is available <a href=https://lief.quarkslab.com/doc/stable/changelog.html#october-16-2017>here</a>
and packages can be downloaded on the <a href=https://lief.quarkslab.com/download>official website</a>.</div><h3 id=development-process>Development process</h3><p>We attach a great importance to the automation of some development tasks like testing, distributing, packaging, etc.
Here is a summary of these processes:</p><p>Each commits is tested on</p><ul><li>Linux - x86-64 - Python{2.7, 3.5, 3.6}</li><li>Windows - x86 / x86-64 - Python{2.7, 3.5, 3.6}</li><li>OSX - x86-64 - Python{2.7, 3.5, 3.6}</li></ul><p>The test suite includes:</p><ul><li>Tests on the Python API</li><li>Tests on the C API</li><li>Tests on the parsers</li><li>Tests on the builders</li></ul><p>If tests succeeds packages are automatically uploaded on the <a href=https://github.com/lief-project/packages>https://github.com/lief-project/packages</a> repository.</p><p>For tagged version, packages are uploaded on the Github release page: <a href=https://github.com/lief-project/LIEF/releases>https://github.com/lief-project/LIEF/releases</a>.</p><h3 id=dockerlief>Dockerlief</h3><p>To facilitate the compilation and the use of LIEF, we created the <a href=https://github.com/lief-project/Dockerlief>Dockerlief</a>
repo which includes various <a href=https://github.com/lief-project/Dockerlief/tree/v0.1.0/dockerlief/dockerfiles>Dockerfiles</a> as well as
the <code>dockerlief</code> utility. <code>dockerlief</code> is basically a wrapper on <em>docker build</em> .</p><p>Among Dockerfiles, we provide a <a href=https://github.com/lief-project/Dockerlief/blob/v0.1.0/dockerlief/dockerfiles/android.docker>Dockerfile</a>
to cross compile LIEF for Android (<code>ARM</code>, <code>AARCH64</code>, <code>x86</code>, <code>x86-64</code>)</p><p>To cross compile LIEF for Android ARM, one can run:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>$ dockerlief build --api-level <span style=color:#099>21</span> --arm lief-android
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span><span style=color:#000;font-weight:700>[</span>INFO<span style=color:#000;font-weight:700>]</span> - Location of the Dockerfiles: ~/dockerfiles
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span><span style=color:#000;font-weight:700>[</span>INFO<span style=color:#000;font-weight:700>]</span> - Building Dockerfile: <span style=color:#d14>&#39;lief-android&#39;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span><span style=color:#000;font-weight:700>[</span>INFO<span style=color:#000;font-weight:700>]</span> - Target architecture: armeabi-v7a
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span><span style=color:#000;font-weight:700>[</span>INFO<span style=color:#000;font-weight:700>]</span> - Target API Level: <span style=color:#099>21</span>
</span></span></code></pre></div><p>The SDK package <code>LIEF-0.8.3-Android_API21_armeabi-v7a.tar.gz</code> is automatically pulled from the Docker to the current directory.</p><h3 id=integration-of-libfuzzer>Integration of LibFuzzer</h3><p>Fuzzing our own library is a good way to detect bugs, memory leak, unsanitized inputs &mldr;</p><p>Thus, we integrated <a href=https://llvm.org/docs/LibFuzzer.html>LibFuzzer</a> in the project. Fuzzing the LIEF ELF, PE, Mach-O parser is as simple as:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#999;font-weight:700;font-style:italic>#include</span> <span style=color:#999;font-weight:700;font-style:italic>&lt;LIEF/LIEF.hpp&gt;</span><span style=color:#999;font-weight:700;font-style:italic>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#999;font-weight:700;font-style:italic>#include</span> <span style=color:#999;font-weight:700;font-style:italic>&lt;vector&gt;</span><span style=color:#999;font-weight:700;font-style:italic>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#999;font-weight:700;font-style:italic>#include</span> <span style=color:#999;font-weight:700;font-style:italic>&lt;memory&gt;</span><span style=color:#999;font-weight:700;font-style:italic>
</span></span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#999;font-weight:700;font-style:italic></span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#000;font-weight:700>extern</span> <span style=color:#d14>&#34;C&#34;</span> <span style=color:#458;font-weight:700>int</span> LLVMFuzzerTestOneInput(<span style=color:#000;font-weight:700>const</span> <span style=color:#458;font-weight:700>uint8_t</span> <span style=color:#000;font-weight:700>*</span>data, size_t size) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>  std<span style=color:#000;font-weight:700>::</span>vector<span style=color:#000;font-weight:700>&lt;</span><span style=color:#458;font-weight:700>uint8_t</span><span style=color:#000;font-weight:700>&gt;</span> raw <span style=color:#000;font-weight:700>=</span> {data, data <span style=color:#000;font-weight:700>+</span> size};
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>  <span style=color:#000;font-weight:700>try</span> {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>    std<span style=color:#000;font-weight:700>::</span>unique_ptr<span style=color:#000;font-weight:700>&lt;</span>LIEF<span style=color:#000;font-weight:700>::</span>Binary<span style=color:#000;font-weight:700>&gt;</span> b{LIEF<span style=color:#000;font-weight:700>::</span>Parser<span style=color:#000;font-weight:700>::</span>parse(raw)};
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>  } <span style=color:#000;font-weight:700>catch</span> (<span style=color:#000;font-weight:700>const</span> LIEF<span style=color:#000;font-weight:700>::</span>exception<span style=color:#000;font-weight:700>&amp;</span> e) {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>    std<span style=color:#000;font-weight:700>::</span>cout <span style=color:#000;font-weight:700>&lt;&lt;</span> e.what() <span style=color:#000;font-weight:700>&lt;&lt;</span> std<span style=color:#000;font-weight:700>::</span>endl;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>  }
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>  <span style=color:#000;font-weight:700>return</span> <span style=color:#099>0</span>;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>}
</span></span></code></pre></div><p>To launch the fuzzer, one can run the following commands:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>$ make fuzz-elf   <span style=color:#998;font-style:italic># Launch ELF Fuzzer</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>$ make fuzz-pe    <span style=color:#998;font-style:italic># Launch PE Fuzzer</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>$ make fuzz-macho <span style=color:#998;font-style:italic># Launch MachO Fuzzer</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>$ make fuzz       <span style=color:#998;font-style:italic># Launch ELF, PE and MachO Fuzzer</span>
</span></span></code></pre></div><h3 id=elf>ELF</h3><h4 id=play-with-elf-symbols---part-2>Play with ELF symbols - Part 2</h4><p>In the <a href=https://lief.quarkslab.com/doc/stable/tutorials/03_elf_change_symbols.html>tutorial #03</a>
we demonstrated how to swap dynamic symbols between a binary and a library. In this part, we will see how we can rename
these symbols.</p><p>Changing symbol names is not a trivial modification, since modifying the string table of the <code>PT_DYNAMIC</code> segment has side effects:</p><ul><li>It requires to update the hash table (GNU Hash / SYSV).</li><li>It usually requires to extend the <code>DYNAMIC</code> part of the ELF format.</li></ul><p>The previous version of LIEF already implements the rebuilding of the hash table but not the extending of the <code>DYNAMIC</code> part.</p><p>With the <code>v0.8.3</code> we can extend the <code>DYNAMIC</code> part. Therefore:</p><ul><li>We can add new entries in the <code>.dynamic</code> section</li><li>We can change dynamic symbols names</li><li>We can change <code>DT_RUNPATH</code> and <code>DT_RPATH</code> without length restriction</li></ul><p>We will rename all <strong>imported</strong> functions of <code>gpg</code> that are imported from <code>libgcrypt.so.20</code> into
<code>a_very_long_name_of_function_XX</code> and all exported functions of <code>libgcrypt.so.20</code> into the same name (<em>XX</em> is the symbol index). <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#000;font-weight:700>import</span> <span style=color:#555>lief</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#998;font-style:italic># Load targets</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>gpg <span style=color:#000;font-weight:700>=</span> lief<span style=color:#000;font-weight:700>.</span>parse(<span style=color:#d14>&#34;/usr/bin/gpg&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>libgcrypt <span style=color:#000;font-weight:700>=</span> lief<span style=color:#000;font-weight:700>.</span>parse(<span style=color:#d14>&#34;/usr/lib/libgcrypt.so.20&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#998;font-style:italic># Change names</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span><span style=color:#000;font-weight:700>for</span> idx, lsym <span style=color:#000;font-weight:700>in</span> <span style=color:#0086b3>enumerate</span>(<span style=color:#0086b3>filter</span>(<span style=color:#000;font-weight:700>lambda</span> e : e<span style=color:#000;font-weight:700>.</span>exported, libgcrypt<span style=color:#000;font-weight:700>.</span>dynamic_symbols)):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>  new_name <span style=color:#000;font-weight:700>=</span> <span style=color:#d14>&#39;a_very_long_name_of_function_</span><span style=color:#d14>{:d}</span><span style=color:#d14>&#39;</span><span style=color:#000;font-weight:700>.</span>format(idx)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>  <span style=color:#0086b3>print</span>(<span style=color:#d14>&#34;New name for &#39;</span><span style=color:#d14>{}</span><span style=color:#d14>&#39;: </span><span style=color:#d14>{}</span><span style=color:#d14>&#34;</span><span style=color:#000;font-weight:700>.</span>format(lsym<span style=color:#000;font-weight:700>.</span>name, new_name))
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>  <span style=color:#000;font-weight:700>for</span> bsym <span style=color:#000;font-weight:700>in</span> <span style=color:#0086b3>filter</span>(<span style=color:#000;font-weight:700>lambda</span> e : e<span style=color:#000;font-weight:700>.</span>name <span style=color:#000;font-weight:700>==</span> lsym<span style=color:#000;font-weight:700>.</span>name, gpg<span style=color:#000;font-weight:700>.</span>dynamic_symbols):
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>    bsym<span style=color:#000;font-weight:700>.</span>name <span style=color:#000;font-weight:700>=</span> new_name
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>  lsym<span style=color:#000;font-weight:700>.</span>name <span style=color:#000;font-weight:700>=</span> new_name
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span><span style=color:#998;font-style:italic># Write back</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>binary<span style=color:#000;font-weight:700>.</span>write(gpg<span style=color:#000;font-weight:700>.</span>name)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>libgcrypt<span style=color:#000;font-weight:700>.</span>write(libgcrypt<span style=color:#000;font-weight:700>.</span>name)
</span></span></code></pre></div><p>By using <code>readelf</code> we can check that function names have been modified:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>$ readelf -s ./gpg|grep <span style=color:#d14>&#34;a_very_long_name&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>   2: <span style=color:#099>0000000000000000</span>     <span style=color:#099>0</span> FUNC    GLOBAL DEFAULT  UND a_very_long_name_of_funct@GCRYPT_1.6 <span style=color:#000;font-weight:700>(</span>2<span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>   3: <span style=color:#099>0000000000000000</span>     <span style=color:#099>0</span> FUNC    GLOBAL DEFAULT  UND a_very_long_name_of_funct@GCRYPT_1.6 <span style=color:#000;font-weight:700>(</span>2<span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>  11: <span style=color:#099>0000000000000000</span>     <span style=color:#099>0</span> FUNC    GLOBAL DEFAULT  UND a_very_long_name_of_funct@GCRYPT_1.6 <span style=color:#000;font-weight:700>(</span>2<span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>  13: <span style=color:#099>0000000000000000</span>     <span style=color:#099>0</span> FUNC    GLOBAL DEFAULT  UND a_very_long_name_of_funct@GCRYPT_1.6 <span style=color:#000;font-weight:700>(</span>2<span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>  ...
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>$ readelf -s ./libgcrypt.so.20|grep <span style=color:#d14>&#34;a_very_long_name&#34;</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>  88: 000000000000d050     <span style=color:#099>6</span> FUNC    GLOBAL DEFAULT   <span style=color:#099>10</span> a_very_long_name_of_funct@@GCRYPT_1.6
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>  89: 000000000000dcd0    <span style=color:#099>69</span> FUNC    GLOBAL DEFAULT   <span style=color:#099>10</span> a_very_long_name_of_funct@@GCRYPT_1.6
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>  90: 000000000000d310    <span style=color:#099>34</span> FUNC    GLOBAL DEFAULT   <span style=color:#099>10</span> a_very_long_name_of_funct@@GCRYPT_1.6
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>  91: 000000000000de70    <span style=color:#099>81</span> FUNC    GLOBAL DEFAULT   <span style=color:#099>10</span> a_very_long_name_of_funct@@GCRYPT_1.6
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>  ...
</span></span></code></pre></div><center><img src=ida_gpg.png alt="GPG Binary in IDA"></center><p>Now if we run the new <code>gpg</code> binary, we get the following error:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>$ ./gpg --output bar.txt --symmetric ./foo.txt
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>relocation error: ./gpg: symbol a_very_long_name_of_function_8, version GCRYPT_1.6 not defined in file libgcrypt.so.20 with link <span style=color:#0086b3>time</span> reference
</span></span></code></pre></div><p>Because the Linux loader tries to resolve the function <code>a_very_long_name_of_function_8</code> against <code>/usr/lib/libgcrypt.so.20</code>
and that library doesn&rsquo;t include the updated names we get the error.</p><p>One way to fix this error is to set the environment variable <code>LD_LIBRARY_PATH</code> to the current directory:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>$ <span style=color:teal>LD_LIBRARY_PATH</span><span style=color:#000;font-weight:700>=</span>. ./gpg --output bar.txt --symmetric ./foo.txt
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>$ xxd ./bar.txt|head -n1
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>00000000: 8c0d <span style=color:#099>0407</span> <span style=color:#099>0302</span> c5af 9fba cab1 <span style=color:#099>9545</span> ebd2  .............E..
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>$ <span style=color:teal>LD_LIBRARY_PATH</span><span style=color:#000;font-weight:700>=</span>. ./gpg --output foo_decrypted.txt --decrypt ./bar.txt
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>$ xxd ./foo_decrypted.txt|head -n1
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">9</span><span>00000000: <span style=color:#099>4865</span> 6c6c 6f20 576f 726c 640a            Hello World.
</span></span></code></pre></div><p>Another way to fix it is to add a new entry in <code>.dynamic</code> section.</p><p>As mentioned at the beginning, we can now add new entries in the <code>.dynamic</code> so let&rsquo;s add
a <code>DT_RUNPATH</code> entry with the <code>$ORIGIN</code> value so that the Linux loader resolves the modified <code>libgcrypt.so.20</code> instead of
the system one:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#000;font-weight:700>...</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span><span style=color:#998;font-style:italic># Add a DT_RUNPATH entry</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>gpg <span style=color:#000;font-weight:700>+=</span> lief<span style=color:#000;font-weight:700>.</span>ELF<span style=color:#000;font-weight:700>.</span>DynamicEntryRunPath(<span style=color:#d14>&#34;$ORIGIN&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span><span style=color:#998;font-style:italic># Write back</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>binary<span style=color:#000;font-weight:700>.</span>write(gpg<span style=color:#000;font-weight:700>.</span>name)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>libgcrypt<span style=color:#000;font-weight:700>.</span>write(libgcrypt<span style=color:#000;font-weight:700>.</span>name)
</span></span></code></pre></div><p>And we don&rsquo;t need the <code>LD_LIBRARY_PATH</code> anymore:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>$ readelf -d ./gpg|grep RUNPATH
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>0x000000000000001d <span style=color:#000;font-weight:700>(</span>RUNPATH<span style=color:#000;font-weight:700>)</span>            Library runpath: <span style=color:#000;font-weight:700>[</span><span style=color:teal>$ORIGIN</span><span style=color:#000;font-weight:700>]</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span>$ ./gpg --decrypt ./bar.txt
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span>gpg: AES encrypted data
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span>gpg: encrypted with <span style=color:#099>1</span> passphrase
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">9</span><span>Hello World
</span></span></code></pre></div><h4 id=hiding-its-symbols>Hiding its symbols</h4><p>While IDA v7.0 has been released recently, among the <a href=https://www.hex-rays.com/products/ida/7.0/index.shtml>changelog</a> one can notice two changes:</p><ul><li><em>ELF: describe symbols using symtab from DYNAMIC section</em></li><li><em>ELF: IDA now uses the PHT by default instead of the SHT to load segments from ELF files</em></li></ul><p>These changes are partially true. Let&rsquo;s see what go wrong in IDA with the following snippet:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#0086b3>id</span> <span style=color:#000;font-weight:700>=</span> lief<span style=color:#000;font-weight:700>.</span>parse(<span style=color:#d14>&#34;/usr/bin/id&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>dynsym <span style=color:#000;font-weight:700>=</span> <span style=color:#0086b3>id</span><span style=color:#000;font-weight:700>.</span>get_section(<span style=color:#d14>&#34;.dynsym&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>dynsym<span style=color:#000;font-weight:700>.</span>entry_size <span style=color:#000;font-weight:700>=</span> dynsym<span style=color:#000;font-weight:700>.</span>size <span style=color:#000;font-weight:700>//</span> <span style=color:#099>2</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span><span style=color:#0086b3>id</span><span style=color:#000;font-weight:700>.</span>write(<span style=color:#d14>&#34;id_test&#34;</span>)
</span></span></code></pre></div><p>This snippet defines the size of <strong>one</strong> symbol as the entire size of <code>.dynsym</code> section divided by 2.</p><p>The <em>normal</em> size of ELF symbols would be:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#000;font-weight:700>&gt;&gt;&gt;</span> <span style=color:#0086b3>print</span>(<span style=color:#0086b3>int</span>(lief<span style=color:#000;font-weight:700>.</span>ELF<span style=color:#000;font-weight:700>.</span>ELF32<span style=color:#000;font-weight:700>.</span>SIZES<span style=color:#000;font-weight:700>.</span>SYM)) <span style=color:#998;font-style:italic># For 32-bits</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span><span style=color:#099>16</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span><span style=color:#000;font-weight:700>&gt;&gt;&gt;</span> <span style=color:#0086b3>print</span>(<span style=color:#0086b3>int</span>(lief<span style=color:#000;font-weight:700>.</span>ELF<span style=color:#000;font-weight:700>.</span>ELF64<span style=color:#000;font-weight:700>.</span>SIZES<span style=color:#000;font-weight:700>.</span>SYM)) <span style=color:#998;font-style:italic># For 64-bits</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span><span style=color:#099>24</span>
</span></span></code></pre></div><p>In the case of the 64-bits <code>id</code> binary, we set this size to <strong>924</strong>.</p><p>When opening <code>id_test</code> in IDA and forcing to use <strong>Segment</strong> for parsing and not <strong>Sections</strong> we get the following <em>imports</em> :</p><div class=my-6><div class=row><div class=col-sm-4><img src=ida_loading.png class="img-fluid rounded shadow-light" alt="IDA Loading Options"></div><div class=col-sm-8><img src=ida_imports.png class="img-fluid rounded shadow-light" alt="IDA Imports overview"></div></div></div>Only one import is resolved and the others are **hidden**.<p>Note that <code>id_test</code> is still executable:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>$ id_test
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span><span style=color:teal>uid</span><span style=color:#000;font-weight:700>=</span>1000<span style=color:#000;font-weight:700>(</span>romain<span style=color:#000;font-weight:700>)</span> <span style=color:teal>gid</span><span style=color:#000;font-weight:700>=</span>1000<span style=color:#000;font-weight:700>(</span>romain<span style=color:#000;font-weight:700>)</span> ...
</span></span></code></pre></div><p>By using <code>readelf</code> we can still retrieve the symbols and we have an error indicating that symbol size is corrupted.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>$ readelf -s id_test
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>readelf: Error: Section <span style=color:#099>5</span> has invalid sh_entsize of 000000000000039c
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>readelf: Error: <span style=color:#000;font-weight:700>(</span>Using the expected size of <span style=color:#099>24</span> <span style=color:#000;font-weight:700>for</span> the rest of this dump<span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>Symbol table <span style=color:#d14>&#39;.dynsym&#39;</span> contains <span style=color:#099>77</span> entries:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>  Num:    Value          Size Type    Bind   Vis      Ndx Name
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>   0: <span style=color:#099>0000000000000000</span>     <span style=color:#099>0</span> NOTYPE  LOCAL  DEFAULT  UND
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>   1: <span style=color:#099>0000000000000000</span>     <span style=color:#099>0</span> FUNC    GLOBAL DEFAULT  UND endgrent@GLIBC_2.2.5 <span style=color:#000;font-weight:700>(</span>2<span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>   2: <span style=color:#099>0000000000000000</span>     <span style=color:#099>0</span> FUNC    GLOBAL DEFAULT  UND __uflow@GLIBC_2.2.5 <span style=color:#000;font-weight:700>(</span>2<span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>   3: <span style=color:#099>0000000000000000</span>     <span style=color:#099>0</span> FUNC    GLOBAL DEFAULT  UND getenv@GLIBC_2.2.5 <span style=color:#000;font-weight:700>(</span>2<span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>   4: <span style=color:#099>0000000000000000</span>     <span style=color:#099>0</span> FUNC    GLOBAL DEFAULT  UND free@GLIBC_2.2.5 <span style=color:#000;font-weight:700>(</span>2<span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>   5: <span style=color:#099>0000000000000000</span>     <span style=color:#099>0</span> FUNC    GLOBAL DEFAULT  UND abort@GLIBC_2.2.5 <span style=color:#000;font-weight:700>(</span>2<span style=color:#000;font-weight:700>)</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>   ...
</span></span></code></pre></div><p>In LIEF the (dynamic) symbol table address is computed through the <code>DT_SYMTAB</code> from the <code>PT_DYNAMIC</code> segment.</p><p>To compute the number of dynamic symbols LIEF uses three heuristics:</p><ol><li>Based on hash tables (<a href=https://github.com/lief-project/LIEF/blob/0.8.3/src/ELF/Parser.tcc#L711-L796>Gnu Hash</a> / <a href=https://github.com/lief-project/LIEF/blob/0.8.3/src/ELF/Parser.tcc#L690-L708>Sysv Hash</a>)</li><li>Based on <a href=https://github.com/lief-project/LIEF/blob/0.8.3/src/ELF/Parser.tcc#L513-L648>relocations</a></li><li>Based on <a href=https://github.com/lief-project/LIEF/blob/0.8.3/src/ELF/Parser.tcc#L653-L672>sections</a></li></ol><p>Malwares start to use this kind of corruption as we will see in the next part.</p><h4 id=rootnik-malware>Rootnik Malware</h4><p>Rootnik is a malware targeting Android devices. It has been analyzed by Fortinet security researcher.</p><p>A full analysis of the malware is available on the <a href=https://blog.fortinet.com/2017/07/09/unmasking-android-malware-a-deep-dive-into-a-new-rootnik-variant-part-i>Fortinet blog</a>.</p><p>This part is focused on the ELF format analysis of one component: <code>libshell</code>.</p><p>Actually there are two libraries <code>libshella_2.10.3.1.so</code> and <code>libshellx_2.10.3.1.so</code>. As they have the same purpose, we will use the x86 version.</p><p>First if we look at the ELF sections of <code>libshellx_2.10.3.1.so</code> we can notice that the <strong>address</strong>, <strong>offset</strong> and <strong>size</strong> of some sections like <code>.text</code>, <code>.init_array</code>, <code>.dynstr</code>, <code>.dynsym</code> are set to 0.</p><p>This kind of modification is used to disturb tools that rely on <strong>sections</strong> to parse some ELF structures (like objdump, readelf, IDA &mldr;)</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>$ readelf -S ./libshellx-2.10.3.1.so
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>There are <span style=color:#099>21</span> section headers, starting at offset 0x2431c:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>Section Headers:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>  <span style=color:#000;font-weight:700>[</span>Nr<span style=color:#000;font-weight:700>]</span> Name              Type            Addr     Off    Size   ES Flg Lk Inf Al
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>  <span style=color:#000;font-weight:700>[</span> 0<span style=color:#000;font-weight:700>]</span>                   NULL            <span style=color:#099>00000000</span> <span style=color:#099>000000</span> <span style=color:#099>000000</span> <span style=color:#099>00</span>      <span style=color:#099>0</span>   <span style=color:#099>0</span>  <span style=color:#099>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>  <span style=color:#000;font-weight:700>[</span> 1<span style=color:#000;font-weight:700>]</span> .dynsym           DYNSYM          <span style=color:#099>00000114</span> <span style=color:#099>000114</span> <span style=color:#099>000300</span> <span style=color:#099>10</span>   A  <span style=color:#099>2</span>   <span style=color:#099>1</span>  <span style=color:#099>4</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>  <span style=color:#000;font-weight:700>[</span> 2<span style=color:#000;font-weight:700>]</span> .dynstr           STRTAB          <span style=color:#099>00000414</span> <span style=color:#099>000414</span> 0001e2 <span style=color:#099>00</span>   A  <span style=color:#099>0</span>   <span style=color:#099>0</span>  <span style=color:#099>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>  <span style=color:#000;font-weight:700>[</span> 3<span style=color:#000;font-weight:700>]</span> .hash             HASH            <span style=color:#099>00000000</span> <span style=color:#099>000000</span> <span style=color:#099>000000</span> <span style=color:#099>04</span>   A  <span style=color:#099>1</span>   <span style=color:#099>0</span>  <span style=color:#099>4</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>  <span style=color:#000;font-weight:700>[</span> 4<span style=color:#000;font-weight:700>]</span> .rel.dyn          REL             <span style=color:#099>00000000</span> <span style=color:#099>000000</span> <span style=color:#099>000000</span> <span style=color:#099>08</span>   A  <span style=color:#099>1</span>   <span style=color:#099>0</span>  <span style=color:#099>4</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>  <span style=color:#000;font-weight:700>[</span> 5<span style=color:#000;font-weight:700>]</span> .rel.plt          REL             <span style=color:#099>00000000</span> <span style=color:#099>000000</span> <span style=color:#099>000000</span> <span style=color:#099>08</span>  AI  <span style=color:#099>1</span>   <span style=color:#099>6</span>  <span style=color:#099>4</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>  <span style=color:#000;font-weight:700>[</span> 6<span style=color:#000;font-weight:700>]</span> .plt              PROGBITS        <span style=color:#099>00000000</span> <span style=color:#099>000000</span> <span style=color:#099>000000</span> <span style=color:#099>04</span>  AX  <span style=color:#099>0</span>   <span style=color:#099>0</span> <span style=color:#099>16</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>  <span style=color:#000;font-weight:700>[</span> 7<span style=color:#000;font-weight:700>]</span> .text             PROGBITS        <span style=color:#099>00000000</span> <span style=color:#099>000000</span> <span style=color:#099>000000</span> <span style=color:#099>00</span>  AX  <span style=color:#099>0</span>   <span style=color:#099>0</span> <span style=color:#099>16</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>  <span style=color:#000;font-weight:700>[</span> 8<span style=color:#000;font-weight:700>]</span> .code             PROGBITS        <span style=color:#099>00000000</span> <span style=color:#099>000000</span> <span style=color:#099>000000</span> <span style=color:#099>00</span>  AX  <span style=color:#099>0</span>   <span style=color:#099>0</span> <span style=color:#099>16</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>  <span style=color:#000;font-weight:700>[</span> 9<span style=color:#000;font-weight:700>]</span> .eh_frame         PROGBITS        <span style=color:#099>00000000</span> <span style=color:#099>000000</span> <span style=color:#099>000000</span> <span style=color:#099>00</span>   A  <span style=color:#099>0</span>   <span style=color:#099>0</span>  <span style=color:#099>4</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>  <span style=color:#000;font-weight:700>[</span>10<span style=color:#000;font-weight:700>]</span> .eh_frame_hdr     PROGBITS        <span style=color:#099>00000000</span> <span style=color:#099>000000</span> <span style=color:#099>000000</span> <span style=color:#099>00</span>   A  <span style=color:#099>0</span>   <span style=color:#099>0</span>  <span style=color:#099>4</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>  <span style=color:#000;font-weight:700>[</span>11<span style=color:#000;font-weight:700>]</span> .fini_array       FINI_ARRAY      <span style=color:#099>00000000</span> <span style=color:#099>000000</span> <span style=color:#099>000000</span> <span style=color:#099>00</span>  WA  <span style=color:#099>0</span>   <span style=color:#099>0</span>  <span style=color:#099>4</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>  <span style=color:#000;font-weight:700>[</span>12<span style=color:#000;font-weight:700>]</span> .init_array       INIT_ARRAY      <span style=color:#099>00000000</span> <span style=color:#099>000000</span> <span style=color:#099>000000</span> <span style=color:#099>00</span>  WA  <span style=color:#099>0</span>   <span style=color:#099>0</span>  <span style=color:#099>4</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span>  <span style=color:#000;font-weight:700>[</span>13<span style=color:#000;font-weight:700>]</span> .dynamic          DYNAMIC         0000ce50 00be50 0000f8 <span style=color:#099>08</span>  WA  <span style=color:#099>2</span>   <span style=color:#099>0</span>  <span style=color:#099>4</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20</span><span>  <span style=color:#000;font-weight:700>[</span>14<span style=color:#000;font-weight:700>]</span> .got              PROGBITS        <span style=color:#099>00000000</span> <span style=color:#099>000000</span> <span style=color:#099>000000</span> <span style=color:#099>00</span>  WA  <span style=color:#099>0</span>   <span style=color:#099>0</span>  <span style=color:#099>4</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21</span><span>  <span style=color:#000;font-weight:700>[</span>15<span style=color:#000;font-weight:700>]</span> .got.plt          PROGBITS        <span style=color:#099>00000000</span> <span style=color:#099>000000</span> <span style=color:#099>000000</span> <span style=color:#099>00</span>  WA  <span style=color:#099>0</span>   <span style=color:#099>0</span>  <span style=color:#099>4</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22</span><span>  <span style=color:#000;font-weight:700>[</span>16<span style=color:#000;font-weight:700>]</span> .data             PROGBITS        <span style=color:#099>00000000</span> <span style=color:#099>000000</span> <span style=color:#099>000000</span> <span style=color:#099>00</span>  WA  <span style=color:#099>0</span>   <span style=color:#099>0</span> <span style=color:#099>16</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23</span><span>  <span style=color:#000;font-weight:700>[</span>17<span style=color:#000;font-weight:700>]</span> .bss              NOBITS          0000d398 00c395 <span style=color:#099>000000</span> <span style=color:#099>00</span>  WA  <span style=color:#099>0</span>   <span style=color:#099>0</span>  <span style=color:#099>4</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24</span><span>  <span style=color:#000;font-weight:700>[</span>18<span style=color:#000;font-weight:700>]</span> .comment          PROGBITS        <span style=color:#099>00000000</span> 00c395 <span style=color:#099>000045</span> <span style=color:#099>01</span>  MS  <span style=color:#099>0</span>   <span style=color:#099>0</span>  <span style=color:#099>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25</span><span>  <span style=color:#000;font-weight:700>[</span>19<span style=color:#000;font-weight:700>]</span> .note.gnu.gold-ve NOTE            <span style=color:#099>00000000</span> 00c3dc 00001c <span style=color:#099>00</span>      <span style=color:#099>0</span>   <span style=color:#099>0</span>  <span style=color:#099>4</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26</span><span>  <span style=color:#000;font-weight:700>[</span>20<span style=color:#000;font-weight:700>]</span> .shstrtab         STRTAB          <span style=color:#099>00000000</span> <span style=color:#099>024268</span> 0000b1 <span style=color:#099>00</span>      <span style=color:#099>0</span>   <span style=color:#099>0</span>  <span style=color:#099>1</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27</span><span>Key to Flags:
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28</span><span>  W <span style=color:#000;font-weight:700>(</span>write<span style=color:#000;font-weight:700>)</span>, A <span style=color:#000;font-weight:700>(</span>alloc<span style=color:#000;font-weight:700>)</span>, X <span style=color:#000;font-weight:700>(</span>execute<span style=color:#000;font-weight:700>)</span>, M <span style=color:#000;font-weight:700>(</span>merge<span style=color:#000;font-weight:700>)</span>, S <span style=color:#000;font-weight:700>(</span>strings<span style=color:#000;font-weight:700>)</span>, I <span style=color:#000;font-weight:700>(</span>info<span style=color:#000;font-weight:700>)</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29</span><span>  L <span style=color:#000;font-weight:700>(</span>link order<span style=color:#000;font-weight:700>)</span>, O <span style=color:#000;font-weight:700>(</span>extra OS processing required<span style=color:#000;font-weight:700>)</span>, G <span style=color:#000;font-weight:700>(</span>group<span style=color:#000;font-weight:700>)</span>, T <span style=color:#000;font-weight:700>(</span>TLS<span style=color:#000;font-weight:700>)</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30</span><span>  C <span style=color:#000;font-weight:700>(</span>compressed<span style=color:#000;font-weight:700>)</span>, x <span style=color:#000;font-weight:700>(</span>unknown<span style=color:#000;font-weight:700>)</span>, o <span style=color:#000;font-weight:700>(</span>OS specific<span style=color:#000;font-weight:700>)</span>, E <span style=color:#000;font-weight:700>(</span>exclude<span style=color:#000;font-weight:700>)</span>,
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31</span><span>  p <span style=color:#000;font-weight:700>(</span>processor specific<span style=color:#000;font-weight:700>)</span>
</span></span></code></pre></div><p>If we open the given library in IDA we have no exports, no imports and no sections:</p><center><img src=libshell_ida.png alt="Libshell in IDA"></center><p>Based on the segments and dynamic entries we can recover most of these information:</p><ul><li><code>.init_array</code> address and size are available through the <code>DT_INIT_ARRAY</code> and <code>DT_INIT_ARRAYSZ</code> entries</li><li><code>.dynstr</code> address and size are available through the <code>DT_STRTAB</code> and <code>DT_STRSZ</code></li><li><code>.dynsym</code> address is available through the <code>DT_SYMTAB</code></li></ul><p>The script <a href=https://gist.github.com/romainthomas/c262be2c29ab374451663b9f6dcdfc0d>recover_shellx.py</a> recovers the missing values, patch sections and rebuild a <em>fixed</em> library.</p><center><img src=libshell_FIXED_ida.png alt="Libshell fixed with LIEF"></center><p>Now if we open the new <code>libshellx-2.10.3.1_FIXED.so</code> we have access to imports / exports and some sections. The <code>.init_array</code> section contains 2 functions:</p><ul><li><code>tencent652524168491435794009</code></li><li><code>sub_60C0</code></li></ul><p>The <code>tencent652524168491435794009</code> function basically do a stack alignment and the <code>sub_60C0</code> is <strong>one</strong> of the decryption routines <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>. This function is obfuscated with graph flattening
and looks like to O-LLVM graph flattening passe <sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>:</p><center><img src=shellx_cfg.png alt="libshell obfuscated CFG with O-LLVM"></center><p>Fortunately there are few <em>&ldquo;relevant blocks&rdquo;</em> and there are not obfuscated.</p><p>The function <code>sub_60C0</code> basically iterates over the program headers to find the encrypted one and decrypt it using a custom algorithm (based on shift, xor, etc).</p><center><img src=shellx_cfg_1.2.png alt="libshell cfg part 1"></center><center><img src=shellx_cfg_2.2.png alt="libshell cfg part 2"></center><hr><h3 id=triggering-cve-2017-1000249>Triggering CVE-2017-1000249</h3><p>The <a href=http://seclists.org/oss-sec/2017/q3/397>CVE-2017-1000249</a> is a stack based buffer overflow in the <code>file</code> utility. It affects the versions
<code>5.29</code>, <code>5.30</code> and <code>5.31</code>.</p><p>Basically the overflow occurs in the size of the note description.</p><p>Using LIEF we can trigger the overflow as follow:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>target <span style=color:#000;font-weight:700>=</span> lief<span style=color:#000;font-weight:700>.</span>parse(<span style=color:#d14>&#34;/usr/bin/id&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>note_build_id <span style=color:#000;font-weight:700>=</span> target[lief<span style=color:#000;font-weight:700>.</span>ELF<span style=color:#000;font-weight:700>.</span>NOTE_TYPES<span style=color:#000;font-weight:700>.</span>BUILD_ID]
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>note_build_id<span style=color:#000;font-weight:700>.</span>description <span style=color:#000;font-weight:700>=</span> [<span style=color:#099>0x41</span>] <span style=color:#000;font-weight:700>*</span> <span style=color:#099>30</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>target<span style=color:#000;font-weight:700>.</span>write(<span style=color:#d14>&#34;id_overflow&#34;</span>)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span>$ file --version
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>file-5.29
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>magic file from /usr/share/file/misc/magic
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>$ id_overflow
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:teal>uid</span><span style=color:#000;font-weight:700>=</span>1000<span style=color:#000;font-weight:700>(</span>romain<span style=color:#000;font-weight:700>)</span> <span style=color:teal>gid</span><span style=color:#000;font-weight:700>=</span>1000<span style=color:#000;font-weight:700>(</span>romain<span style=color:#000;font-weight:700>)</span> ...
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>$ file id_overflow
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>*** buffer overflow detected ***: file terminated
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>./id_overflow: <span style=color:#000;font-weight:700>[</span>1<span style=color:#000;font-weight:700>]</span> <span style=color:#099>3418</span> abort <span style=color:#000;font-weight:700>(</span>core dumped<span style=color:#000;font-weight:700>)</span>  file ./id_overflow
</span></span></code></pre></div><p>Here is the commit that introduced the bug: <a href=https://github.com/file/file/commit/9611f31313a93aa036389c5f3b15eea53510d4d1#diff-bc5c24ef9f39a5f4963ca28ecbc645b3L512>9611f3</a></p><h2 id=pe>PE</h2><p>The <em>Load Config</em> directory is now parsed into the
<a href=https://github.com/lief-project/LIEF/blob/0.8.3/include/LIEF/PE/LoadConfigurations/LoadConfiguration.hpp>LoadConfiguration</a> object.
This structure evolves with the Windows versions and LIEF has been designed to support this evolution.
You can take a look at <a href=https://github.com/lief-project/LIEF/blob/0.8.3/include/LIEF/PE/LoadConfigurations/LoadConfigurationV0.hpp#L47-L52>LoadConfigurationV0</a>,
<a href=https://github.com/lief-project/LIEF/blob/0.8.3/include/LIEF/PE/LoadConfigurations/LoadConfigurationV6.hpp#L47-L54>LoadConfigurationV6</a>.</p><p>One can find the different versions of this structure in the following directories:</p><ul><li><code>include/LIEF/PE/LoadConfigurations</code></li><li><code>src/PE/LoadConfigurations</code></li></ul><p>The current version of LIEF is able to parse the structure up to Windows 10 build 15002 with the <em>hotpatch table offset</em>.</p><p>Here are some examples of the <code>LoadConfiguration</code> API:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#000;font-weight:700>&gt;&gt;&gt;</span> target <span style=color:#000;font-weight:700>=</span> lief<span style=color:#000;font-weight:700>.</span>parse(<span style=color:#d14>&#34;PE64_x86-64_binary_WinApp.exe&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span><span style=color:#000;font-weight:700>&gt;&gt;&gt;</span> target<span style=color:#000;font-weight:700>.</span>has_configuration
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span><span style=color:#000;font-weight:700>True</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span><span style=color:#000;font-weight:700>&gt;&gt;&gt;</span> config <span style=color:#000;font-weight:700>=</span> target<span style=color:#000;font-weight:700>.</span>load_configuration
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5</span><span><span style=color:#000;font-weight:700>&gt;&gt;&gt;</span> config<span style=color:#000;font-weight:700>.</span>version
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6</span><span>WIN_VERSION<span style=color:#000;font-weight:700>.</span>WIN10_0_15002
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7</span><span><span style=color:#000;font-weight:700>&gt;&gt;&gt;</span> <span style=color:#0086b3>hex</span>(config<span style=color:#000;font-weight:700>.</span>guard_rf_failure_routine)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">8</span><span><span style=color:#d14>&#39;0x140001040&#39;</span>
</span></span></code></pre></div><p>LIEF also provides an API to serialize any ELF or PE objects into JSON <sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup></p><p>For examples to transform <code>LoadConfiguration</code> object into Json:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#000;font-weight:700>&gt;&gt;&gt;</span> <span style=color:#000;font-weight:700>from</span> <span style=color:#555>lief</span> <span style=color:#000;font-weight:700>import</span> to_json
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span><span style=color:#000;font-weight:700>&gt;&gt;&gt;</span> to_json(config)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span><span style=color:#d14>&#39;{&#34;characteristics&#34;:248,&#34;code_integrity&#34;:{&#34;catalog&#34;:0,&#34;catalog_offset&#34;:0 ... }}&#39;</span> <span style=color:#998;font-style:italic># Not fully printed</span>
</span></span></code></pre></div><p>One can also serialize the whole Binary object:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#000;font-weight:700>&gt;&gt;&gt;</span> to_json(target)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span><span style=color:#d14>&#39;{&#34;data_directories&#34;:[{&#34;RVA&#34;:0,&#34;size&#34;:0,&#34;type&#34;:&#34;EXPORT_TABLE&#34;},{&#34;RVA&#34;:62584,&#34;section&#34; ...}}&#39;</span> <span style=color:#998;font-style:italic># # Not fully printed</span>
</span></span></code></pre></div><h3 id=mach-o>Mach-O</h3><p>For Mach-O binary, dynamic executables embed the <code>LC_DYLD_INFO</code> command which is associated with the <code>dyld_info_command</code> structure.</p><p>The structure is basically a <em>list</em> of offsets and sizes pointing to other data structures.</p><p>From <code>/usr/lib/mach-o/loader.h</code> the structure looks like this:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#000;font-weight:700>struct</span> <span style=color:#458;font-weight:700>dyld_info_command</span> {
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>  <span style=color:#458;font-weight:700>uint32_t</span>   cmd;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>  <span style=color:#458;font-weight:700>uint32_t</span>   cmdsize;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>  <span style=color:#458;font-weight:700>uint32_t</span>   rebase_off;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>  <span style=color:#458;font-weight:700>uint32_t</span>   rebase_size;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>  <span style=color:#458;font-weight:700>uint32_t</span>   bind_off;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>  <span style=color:#458;font-weight:700>uint32_t</span>   bind_size;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>  <span style=color:#458;font-weight:700>uint32_t</span>   weak_bind_off;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>  <span style=color:#458;font-weight:700>uint32_t</span>   weak_bind_size;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>  <span style=color:#458;font-weight:700>uint32_t</span>   lazy_bind_off;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>  <span style=color:#458;font-weight:700>uint32_t</span>   lazy_bind_size;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>  <span style=color:#458;font-weight:700>uint32_t</span>   export_off;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>  <span style=color:#458;font-weight:700>uint32_t</span>   export_size;
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>};
</span></span></code></pre></div><p>The <code>dyld</code> loader uses this structure to:</p><ul><li>Rebase the executable</li><li>Bind symbols to addresses</li><li>Retrieve exported functions (or symbols)</li></ul><p>Whereas in the ELF and PE format relocations are basically a <strong>table</strong>, Mach-O format uses <strong>byte streams</strong> to rebase the image and to bind symbols with addresses.
For exports it uses a <strong>trie</strong> as subjacent structure.</p><p>In the new version of LIEF, the Mach-O parser is able to handle these underlying structures to provide an user-friendly API:</p><p>The export trie is represented by the <a href=https://github.com/lief-project/LIEF/blob/0.8.3/include/LIEF/MachO/ExportInfo.hpp>ExportInfo</a> object which is usually
tied to a <a href=https://github.com/lief-project/LIEF/blob/master/include/LIEF/MachO/Symbol.hpp>Symbol</a>.
The binding byte stream is represented trough the <a href=https://github.com/lief-project/LIEF/blob/0.8.3/include/LIEF/MachO/BindingInfo.hpp>BindingInfo</a> object.</p><p>For the rebase byte stream, the parser create <em>virtual relocations</em> to model the rebasing process. These <em>virtual relocations</em> are represented by the <a href=https://github.com/lief-project/LIEF/blob/0.8.3/include/LIEF/MachO/RelocationDyld.hpp>RelocationDyld</a>
object and among other attributes it contains <code>address</code>, <code>size</code> and <code>type</code> <sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>.</p><p>Here is an example using the Python API:</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#000;font-weight:700>&gt;&gt;&gt;</span> <span style=color:#0086b3>id</span> <span style=color:#000;font-weight:700>=</span> lief<span style=color:#000;font-weight:700>.</span>parse(<span style=color:#d14>&#34;/usr/bin/id&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#000;font-weight:700>&gt;&gt;&gt;</span> <span style=color:#0086b3>print</span>(<span style=color:#0086b3>id</span><span style=color:#000;font-weight:700>.</span>relocations[<span style=color:#099>0</span>])
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span><span style=color:#099>100002000</span> POINTER <span style=color:#099>64</span> DYLDINFO __DATA<span style=color:#000;font-weight:700>.</span>__eh_frame dyld_stub_binder
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span><span style=color:#000;font-weight:700>&gt;&gt;&gt;</span> <span style=color:#0086b3>print</span>(<span style=color:#0086b3>id</span><span style=color:#000;font-weight:700>.</span>has_dyld_info)
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#000;font-weight:700>True</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span><span style=color:#000;font-weight:700>&gt;&gt;&gt;</span> dyldinfo <span style=color:#000;font-weight:700>=</span> <span style=color:#0086b3>id</span><span style=color:#000;font-weight:700>.</span>dyld_info
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span><span style=color:#000;font-weight:700>&gt;&gt;&gt;</span> <span style=color:#0086b3>print</span>(dyldinfo<span style=color:#000;font-weight:700>.</span>bindings[<span style=color:#099>0</span>])
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>Class:       STANDARD
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>Type:        POINTER
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>Address:     <span style=color:#099>0x100002010</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>Symbol:      ___stderrp
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>Segment:     __DATA
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>Library:     <span style=color:#000;font-weight:700>/</span>usr<span style=color:#000;font-weight:700>/</span>lib<span style=color:#000;font-weight:700>/</span>libSystem<span style=color:#000;font-weight:700>.</span>B<span style=color:#000;font-weight:700>.</span>dylib
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span><span style=color:#000;font-weight:700>&gt;&gt;&gt;</span> <span style=color:#0086b3>print</span>(dyldinfo<span style=color:#000;font-weight:700>.</span>exports[<span style=color:#099>0</span>])
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>Node Offset: <span style=color:#099>18</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>Flags:       <span style=color:#099>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>Address:     <span style=color:#099>0</span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>Symbol:      __mh_execute_header
</span></span></code></pre></div><h3 id=conclusion>Conclusion</h3><p>In this release we did a large improvement of the ELF builder. Mach-O and PE parts gain new objects and new functions.
LIEF is now available on <a href=https://pypi.python.org/pypi/lief>PyPI</a> and can be
added in the <em>requirements</em> of Python projects whatever the Python version and the target platform.</p><p>Since the <code>v0.7.0</code> LIEF has been presented at <a href="https://prog2017.rmll.info/programme/securite-entre-transparence-et-opacite/lief-bibliotheque-d-instrumentation-de-formats-executables-mais-ca-fait-bife-c?lang=en">RMLL</a>
and the <a href=http://www.misp-project.org>MISP</a> project uses it for its <em>PyMISP objects</em>.</p><p>Some may complain about the C API. They are right! Until the <code>v1.0.0</code> we will provide a minimal C API. Once C++ API is stable we plan to provide full APIs for Python, C, Java, OCaml <sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup>, etc.</p><p>Next version should be focused on the Mach-O builder especially for adding sections and segments. We also plan to support PE <code>.NET</code> headers and fix some performances issues.</p><p>For questions you can join the <a href=https://gitter.im/lief-project>Gitter channel</a></p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>All Python examples are done with the 3.5 version&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>See the blog post about O-LLVM analysis: <a href=https://blog.quarkslab.com/deobfuscation-recovering-an-ollvm-protected-program.html>https://blog.quarkslab.com/deobfuscation-recovering-an-ollvm-protected-program.html</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>As mentioned in the Fortinet blog post, the library is packed.&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p>This feature is not yet available for MachO objects&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p>Due to the inheritance relationship and abstraction these attributes are located in the <a href=https://github.com/lief-project/LIEF/blob/0.8.3/include/LIEF/MachO/Relocation.hpp#L72-L83>MachO::Relocation</a>
and <a href=https://github.com/lief-project/LIEF/blob/0.8.3/include/LIEF/Abstract/Relocation.hpp#L39-L43>LIEF::Relocation</a> objects.&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6><p><a href=https://github.com/aziem/LIEF-ocaml>https://github.com/aziem/LIEF-ocaml</a>&#160;<a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><div class="d-flex flex-column flex-sm-row align-items-center border-top border-gray-200 mt-6 py-5"><div class=media><div class="avatar mr-4"><img src=https://lief.re/img/avatar/romain.png class="avatar-image rounded-circle" alt=Avatar></div><div class=media-body><span class="text-darkblue text-uppercase-xs font-weight-bolder"><a href=https://www.romainthomas.fr target=_blank>Romain Thomas
</a></span><span class="text-muted font-size-sm d-block">Posted on October 30, 2017</span></div></div></div></div></div></div></section><footer class="footer footer-dark bg-dark"><div class="container text-center"><div class=row><div class="col-12 col-md"><h6 class="footer-header mb-4 pb-md-2">LIEF</h6><a href=https://github.com/lief-project/LIEF class=footer-link>Github
</a><a href=https://lief.re//download class="footer-link mt-2">Download
</a><a href=https://lief.re//doc/latest class="footer-link mt-2">Documentation</a></div><div class="col-12 col-md mt-5 mt-md-0"><h6 class="footer-header mb-4 pb-md-2">Quarkslab</h6><a href=https://blog.quarkslab.com/ class=footer-link>Blog
</a><a href=https://quarkslab.com/ class="footer-link mt-2">Website</a></div><div class="col-12 col-md mt-5 mt-md-0"><h6 class="footer-header mb-4 pb-md-2">Other Tools</h6><a href=https://qbdi.quarkslab.com/ class=footer-link>QBDI
</a><a href=https://triton.quarkslab.com/ class="footer-link mt-2">Triton</a></div></div><div class="d-flex justify-content-center mt-6"><a href=https://infosec.exchange/@rh0main class="hover-lift-light text-decoration-none mx-2"><span class="icon-circle footer-social-icon"><i class="fab fa-mastodon fa-lg"></i>
</span></a><a href=https://x.com/lief_project class="hover-lift-light text-decoration-none mx-2"><span class="icon-circle footer-social-icon"><i class="fab fa-x-twitter fa-lg"></i>
</span></a><a href=https://crates.io/crates/lief class="hover-lift-light text-decoration-none mx-2"><span class="icon-circle footer-social-icon"><i class="fab fa-rust fa-lg"></i>
</span></a><a href=https://pypi.org/project/lief/ class="hover-lift-light text-decoration-none mx-2"><span class="icon-circle footer-social-icon"><i class="fab fa-python fa-lg"></i>
</span></a><a href=https://github.com/lief-project/LIEF class="hover-lift-light text-decoration-none mx-2"><span class="icon-circle footer-social-icon"><i class="fab fa-github fa-lg"></i>
</span></a><a href=https://discord.gg/jGQtyAYChJ class="hover-lift-light text-decoration-none mx-2"><span class="icon-circle footer-social-icon"><i class="fab fa-discord fa-lg"></i></span></a></div></div></footer><script src=https://lief.re//js/vendor.min.js></script><script src=https://lief.re//js/theme.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js></script><script>$("#copy").tooltip({trigger:"click",placement:"bottom"});function setTooltip(e){$("#copy").tooltip("hide").attr("data-original-title",e).tooltip("show")}function hideTooltip(){setTimeout(function(){$("#copy").tooltip("hide")},1e3)}var clipboard=new ClipboardJS("#copy");clipboard.on("success",function(){setTooltip("Copied!"),hideTooltip()}),clipboard.on("error",function(){setTooltip("Failed!"),hideTooltip()})</script></body></html>